# info:          sources environment variables from `.env` file during deployment
# installation : run 'podi recipe env-file' or put this file into .podi folder 
# example usage: * put an .env file in your repo (with 'export FOO=1' e.g.)
#                * override them on remote-server using './podi .env git@server FOO=2'
#                * run './podi .env' to see all local/remote env-vars 

jail(){ # jail : enable automatic ssh-into-container (docker/podman)
  install(){
    script='
      u=$(whoami)
      test $u = "root" || {
        podman run -it -v /home/$u:/home/$u -w /home/$u alpine:latest /bin/sh
        exit
      }
    '
    echo "$script" | awk '{$1=$1};1' 
  }
  test -z $1 && { echo 'Usage: ./podi podmanjail install | ssh root@yourserver "cat > /etc/profile.d/podmanjail.sh"'; exit; }
  "$@"
}

